<!DOCTYPE html>
<html>
<head>
    <title>Commit Bubbles</title>
		<link href="http://nvd3.org//assets/css/nv.d3.css" rel="stylesheet">
		<script src="http://nvd3.org/assets/lib/d3.v3.js"></script>
		<script src="http://nvd3.org/assets/js/nv.d3.js"></script>
    <script>
            all_commits = [
              {author: "John Doe", commits:  [{
                time: 100,
                hash: "1234567890",
                testPercentage: 100,
                size: 44,
              },
							{
                time: 200,
                hash: "1234567890",
                testPercentage: 90,
                size: 84,
              }]},
              {author: "Nancy", commits:  [{
                time: 150,
                hash: "1234567890",
                testPercentage: 50,
                size: 244,
              },
							{
                time: 300,
                hash: "1234567890",
                testPercentage: 10,
                size: 144,
              }]},
              {author: "Mildred", commits: [{
                time: 455,
                hash: "1234567890",
                testPercentage: 15,
                size: 22,
              }]}];
    </script>
</head>
<body bgcolor="#FFFFFF">
  <div id="graph"><svg style="height: 600px; width: 600px"></svg></div>
</body>

<script>
nv.addGraph(function() {
  var chart = nv.models.scatterChart()
		 .color(d3.scale.category10().range());

  chart.tooltipContent(function(key) {
      return '<h3>' + key + '</h3>';
  });

  d3.select('#graph svg')
      .datum(transformData(all_commits))
      .call(chart);

  return chart;
});

function transformData(all_commits) {
  var data = [];

  for (i = 0; i < all_commits.length; i++) {
    var commits_by_author = all_commits[i];
    data.push({
      key: commits_by_author.author,
      values: []
    });

    var commits = commits_by_author.commits;
    for (j = 0; j < commits.length; j++) {
      data[i].values.push({
        x: commits[j].time,
	y: commits[j].testPercentage,
	size: commits[j].size
      });
    }
  }

  return data;
}
</script>
</html>
